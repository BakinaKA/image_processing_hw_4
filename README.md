# Лабораторная работа: обработка отпечатка пальца с помощью фильтров Габора.
Выполнили: Бакина Ксения, Круглов Алексей.
На необработанном изображении из-за различных помех линии отпечатков могут искажаться, 
что может повлечь за собой ошибки в распознавании признаков (петли, дельты и завитки).
Чтобы этого избежать изображение улучшают. Для этого наиболее часто используются методы 
на основе фильтра Габора, который учитывает периодическую структуру изображений. 
Вэтой лабораторной работе мы реализовали параметризованный фильтр Габора, подходящий 
для улучшения изображений, содержащих кривые линии и завитки, которые присутствуют 
на изображениях отпечатков пальцев.


Классический вид фильтра Габора:
`h(x, y) = exp(-(x^2+y^2)/(2*σ^2))*cos2πf(xsinθ + ycosθ)`,
где x, y – координаты точки; 
σ – стандартное отклонение предполагаемого нормального распределения; 
f – частота; 
θ – ориентация фильтра (параметры σ и f относятся к маске фильтра, 
а угол θ – к ориентации маски над изображением).

Мы старались подобрать такие σ и θ, чтобы фильтр работал наилушим образом.
Сначала мы зафиксировали массив `{θ₁, θ₂, θ₃,...}` в значение `{0, 30, 60, 90, 120, 150}`
и меняли σ.

Исходные изображения:

![finger1](https://user-images.githubusercontent.com/61293111/147298896-38a90bf5-c4c3-4215-abb8-ff35f67e8870.jpg)   ![finger2](https://user-images.githubusercontent.com/61293111/147298909-0ae27c47-0b7b-4fe9-aa76-85083c1e401b.jpg)


`σ = 0.9`

![out_1_0 9](https://user-images.githubusercontent.com/61293111/147298982-2c1de6a2-f681-4938-bbcc-2ac53929ffcf.jpg)   ![out_2_0 9](https://user-images.githubusercontent.com/61293111/147299007-df26eabd-4304-460c-8bcf-27f9ca31b968.jpg)

`σ = 1.5`

![out_1_1 5](https://user-images.githubusercontent.com/61293111/147299130-5d433300-3217-4721-ac87-93ee4d2ada4e.jpg)    ![out_2_1 5](https://user-images.githubusercontent.com/61293111/147299148-25b60d7b-4b1b-4ca9-8976-c5eff736f53d.jpg)

`σ = 1.8`

![out_1_1 8](https://user-images.githubusercontent.com/61293111/147299175-23bde5d5-f9d8-43d3-a246-12674bd4218e.jpg)    ![out_2_1 8](https://user-images.githubusercontent.com/61293111/147299186-3b3f03a9-3a46-45d3-af93-1c407eebedcf.jpg)


Нас устроил вариант обработки при `σ = 1.5`, это золотая середина. При уменьшении `σ` линии 
начинают затираться, разрываться и истончаться, изображение ухудшается (обратите внимание 
на изображения при `σ = 0.9`). С другой стороны, при увеличении `σ` линии начитают расплываться, 
близко расположенные линии сливаются (посмотрите на изображения при `σ = 0.9`).

Теперь зафиксируем `σ = 1.5` и попробуем менять массив `{θ ₁, θ₂, θ₃,...}`.
`{0, 45, 90, 135}`

![out_1(0,45,90 )](https://user-images.githubusercontent.com/61293111/147300548-a1e25c80-84c4-42e5-92ab-bf0db966de94.jpg)    ![out_2(0,45 )](https://user-images.githubusercontent.com/61293111/147300558-3cfca782-b27f-419b-ab3d-fbbbb0ed249e.jpg)

`{0, 30, 60, 90, 120, 150}`

![out_1(0,30,60 )](https://user-images.githubusercontent.com/61293111/147300574-740d593c-a0f9-48d8-a465-9a1062038c17.jpg)   ![out_2(0,30 )](https://user-images.githubusercontent.com/61293111/147300586-d7f46b5a-8255-4bbe-b745-6299b8370834.jpg)

`{0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180}`

![out_1(0,10 )](https://user-images.githubusercontent.com/61293111/147300604-d12fa1a5-0234-4305-8a6b-24ac10317fd1.jpg)    ![out_2(0,10 )](https://user-images.githubusercontent.com/61293111/147300618-bd9f0e96-22f4-466d-ba04-737fd66f7bfa.jpg)

При изменении массива `{θ₁, θ₂, θ₃,...}` (а точнее при его расширении) результирующее изображение меняется едва заметно. 
Поэтому мы определили как оптимальный массив `{0, 30, 60, 90, 120, 150}`, он показывает результаты лучше чем `{0, 45, 90, 135}` и не требует такого количества вычислений как массив `{0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180}`.
